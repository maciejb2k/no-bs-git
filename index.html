<!DOCTYPE html>
<html lang="en">
  <head>
    <title>No Bullshit Git</title>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Learn git once and for all." />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Fira+Code&display=swap"
      rel="stylesheet"
    />

    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="mobile-nav">
      <button class="mobile-nav__close">
        <svg
          class="h-6 w-6"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
      <p class="nav__title">On this page:</p>
      <ul class="nav-list">
        <li>
          <a href="#" class="nav-link">Home</a>
        </li>
      </ul>
    </div>
    <div class="menu-background"></div>
    <div class="container">
      <header class="header">
        <div class="header__left">
          <a href="#">
            <img
              src="assets/logo_color.png"
              alt="text with name of the website"
              class="header__logo"
            />
          </a>
        </div>
        <div class="header__right">
          <a href="#" class="github-button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              viewBox="0 0 1792 1792"
            >
              <path
                d="M896 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 .5-76.5t.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 88.5t.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zm-477 1103q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zm31 34q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zm30 45q9-7 0-19-8-13-17-6-9 5 0 18t17 7zm42 42q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zm57 25q3-11-13-16-15-4-19 7t13 15q15 6 19-6zm63 5q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zm58-10q-2-11-18-9-16 3-14 15t18 8 14-14z"
              ></path>
            </svg>
            <span>GitHub</span>
          </a>
          <button class="nav-toggle-button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              viewBox="0 0 1792 1792"
            >
              <path
                d="M1664 1344v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45z"
              ></path>
            </svg>
          </button>
        </div>
      </header>
      <div class="wrapper">
        <aside class="nav">
          <p class="nav__title">On this page:</p>
          <ul class="nav-list">
            <li>
              <a href="#" class="nav-link">Home</a>
            </li>
          </ul>
        </aside>
        <div class="content">
          <main>
            <div class="group">
              <h2 class="heading heading--h2">Boring preface</h2>
              <p class="text">
                <b>Git is hard for beginners</b>. Do you have similar feelings?
                I think most of you can agree with that. Git was very hard for
                me, and after months of struggling with Git, I finally found out
                why.
              </p>
              <p class="text">
                <b
                  >In my opinion, the problem is that nobody starts learning Git
                  with a full understanding of a
                  <span class="code">.git/</span> directory.</b
                >
              </p>
              <p class="text">
                Most of the tutorials and articles starts explaning Git with
                some abstract concepts. The <b>commits</b> are some "colorful
                dots", the <b>branches</b> are "dots connected together", like a
                metro stations on the map and so on.
              </p>
              <p class="text">
                I think these guides are absolute garbage, because when you need
                to think about solving a real problem with Git, your mind goes
                blank because you don't even know what it's all about.
              </p>
              <p class="text">
                <b>Git is not a blackbox, which somehow works</b>. I want this
                guide to provide sufficient basics, so you don't have to suffer
                every time something goes wrong in Git.
              </p>
            </div>

            <div class="group">
              <h2 class="heading heading--h2">Before we start</h2>
              <p class="text">
                <a href="https://git-scm.com/downloads" target="_blank"
                  >Install Git</a
                >
                and make sure it works by typing:
                <span class="code">git --version</span>
              </p>
              <p class="text">
                <b>You have to learn how to use Git from the command line</b>. I
                don't care about your paid GUI tools or some useless VSCode
                extensions. If you want to understand it, you have to use it
                from the command line.
              </p>
            </div>

            <div class="group">
              <h2 class="heading heading--h2">Creating a Git repository</h2>
              <p class="text">
                <span class="code">git init</span> creates a hidden
                <span class="code">.git/</span>
                directory in the current location.
              </p>
              <p class="text">
                Git determines whether you are inside a Git repository by,
                checking if there is a <span class="code">.git/</span> directory
                at the root of the directory.
              </p>
              <p class="text text--label">
                Take a look what is inside
                <span class="code">.git/</span> directory:
              </p>
              <pre><code class="code-block">$ cd .git/ && ls -al

total 32K
-rw-r--r-- 1 gigachad gigachad   23 Sep  8 13:19 HEAD
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 13:19 branches
-rw-r--r-- 1 gigachad gigachad   92 Sep  8 13:19 config
-rw-r--r-- 1 gigachad gigachad   73 Sep  8 13:19 description
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 13:19 hooks
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 13:19 info
drwxr-xr-x 4 gigachad gigachad 4.0K Sep  8 13:19 objects
drwxr-xr-x 4 gigachad gigachad 4.0K Sep  8 13:19 refs</code></pre>
              <p class="text">
                Familirize yourself with these files and directories and don't
                do anything else for now. We will be focusing on the
                <span class="code">objects/</span> and
                <span class="code">refs/</span> directories in the next parts.
              </p>
            </div>

            <div class="group">
              <h2 class="heading heading--h2">SHA-1</h2>
              <p class="text">Everything in Git is based on <b>SHA-1</b>.</p>
              <p class="text">
                It is a
                <a href="https://en.wikipedia.org/wiki/SHA-1" target="_blank"
                  >cryptographic hash function</a
                >. You don't have to know how it mathematically works. You have
                to remember, that it takes any piece of text and turns it into
                <b>unique 40-character string of letters and numbers</b>. It's
                impossible to get back the original text from this unique
                string.
              </p>
              <div class="form">
                <div class="form__group">
                  <label for="sha1-input" class="form__label">Input:</label>
                  <input
                    class="form__input"
                    id="sha1-input"
                    type="text"
                    value="Play around with the input!"
                  />
                </div>
                <div class="form__group">
                  <label for="sha1-output" class="form__label"
                    >SHA-1 Output:</label
                  >
                  <input
                    class="form__input"
                    id="sha1-output"
                    type="text"
                    disabled
                  />
                </div>
              </div>
              <p class="text">
                If you are wondering, what if SHA-1 will produce the same output
                for two different inputs, you can read about
                <a
                  href="https://en.wikipedia.org/wiki/Hash_collision"
                  target="_blank"
                  >collisions of hash functions</a
                >.
              </p>
              <p class="text">
                <b>Spoiler</b>: You will find that the probability of collision
                is extremly low. Also, you will learn that SHA-1 is not secure
                anymore, but it doesn't matter, because it is not used for
                security in Git.
              </p>
            </div>

            <div class="group">
              <h2 class="heading heading--h2">The primary role of Git</h2>
              <p class="text">
                At the lowest conceptual level, Git is just a simple
                <b>key:value</b> store.
              </p>
              <p class="text">
                It calculates the SHA-1 hash of the given input, which may be a
                text file, photo, pdf or anything else. Then it stores the input
                under the name of the calculated SHA-1 hash. This explanation is
                very simplified, but it is enough for now, just to understand
                the core concept of Git.
              </p>
              <p class="text text--label">
                You can try it by yourself with the following command:
              </p>
              <pre><code class="code-block">$ echo "hello world" | git hash-object --stdin
3b18e512dba79e4c8300dd08aeb37f8e728b8dad</code></pre>
            </div>
            <div class="group">
              <h2 class="heading heading--h2">Types of objects in Git</h2>
              <p class="text">
                You may notice, that the output of the command above differs
                from the one you got in the form above. To explain this
                behaviours, we need to introduce new terms.
              </p>
              <p class="text">
                Git has four types of objects:
                <span class="code">blob</span>, <span class="code">tree</span>,
                <span class="code">commit</span> and
                <span class="code">tag</span>.
              </p>
            </div>
            <div class="group">
              <h2 class="heading heading--h2">Blob</h2>
              <p class="text">
                Blob is a <b>generic piecie of content</b>. Blob is just a text
                file, which is stored in the
                <span class="code">.git/objects/</span> directory.
              </p>
              <p class="text text--label">Blob is structured as follows:</p>
              <pre><code class="code-block">header + content</code></pre>
              <p class="text text--label">
                The <b>header</b> consists of the object type, which in our case
                is a blob, a single whitespace, its size in bytes and a NULL
                byte:
              </p>
              <pre><code class="code-block">&lt;object type&gt; &lt;size of content in bytes&gt;\0

blob 12\0</code></pre>
              <p class="text">
                The <b>content</b> is the content (stdin, content of the file,
                etc.), which we want to store.
              </p>
            </div>
            <div class="group">
              <h2 class="heading heading--h2">Creating a Blob</h2>
              <p class="text text--label">
                For instance, we want to store the content of the file
                <span class="code">hello.txt</span>:
              </p>
              <pre><code class="code-block">what is up, doc?</code></pre>
              <p class="text text--label">The blob will look like this:</p>
              <pre><code class="code-block">blob 17\0what is up, doc?</code></pre>
              <p class="text text--label">
                The <span class="code">git hash-object</span> command creates a
                blob and calculates its SHA-1 hash (it doesn't persists it):
              </p>
              <pre><code class="code-block">$ echo -n "what is up, doc?" | git hash-object --stdin
bd9dbf5aae1a3862dd1526723246b20206e5fc37</code></pre>
              <p class="text">
                Check out how the blob is created using the form below:
              </p>
              <div class="form">
                <div class="form__group">
                  <label for="blob-input" class="form__label">Content:</label>
                  <input
                    class="form__input"
                    id="blob-input"
                    type="text"
                    value="what is up, doc?"
                  />
                </div>
                <div class="form__group">
                  <label for="blob-sha1" class="form__label">SHA-1:</label>
                  <input
                    class="form__input"
                    id="blob-sha1"
                    type="text"
                    disabled
                  />
                </div>
                <div class="form__group">
                  <label for="blob-content" class="form__label">Blob:</label>
                  <textarea
                    class="form__input"
                    name=""
                    id="blob-content"
                    cols="30"
                    rows="5"
                    disabled
                  ></textarea>
                </div>
                <div class="form__group">
                  <label for="blob-compressed" class="form__label"
                    >Compressed content (HEX):</label
                  >
                  <textarea
                    class="form__input"
                    name=""
                    id="blob-compressed"
                    cols="30"
                    rows="5"
                    disabled
                  ></textarea>
                </div>
              </div>
            </div>
            <div class="group">
              <h2 class="heading heading--h2">Compressing the Blob</h2>
              <p class="text">
                As you may notice in the form above, there is an extra field
                called <b>compressed content</b>.
              </p>
              <p class="text">
                Git is smart enough to <b>compress</b> the content of the blob
                before it is stored in the
                <span class="code">.git/objects/</span> directory.
              </p>
              <p class="text text--label">
                Git uses the
                <a href="https://en.wikipedia.org/wiki/Deflate" target="_blank"
                  >Deflate</a
                >
                data compression algorithm. Before saving the blob, Git
                calculates the SHA-1 of the header + content, then compresses
                it:
              </p>
              <pre><code class="code-block">Order of operations:
1. header + content
2. SHA-1 of header + content
3. compress the header + content
4. save the compressed header + content in .git/objects/ under the name of the SHA-1 hash</code></pre>
              <p class="text text--label">
                This time, with <span class="code">-w</span> flag, our blob will
                be saved to the
                <span class="code">.git/objects</span> directory:
              </p>
              <pre><code class="code-block">$ echo -n "what is up, doc?" | git hash-object --stdin -w
bd9dbf5aae1a3862dd1526723246b20206e5fc37</code></pre>
              <p class="text text--label">
                Git groups the blobs in the directories by the
                <b>first two characters</b> of the blob:
              </p>
              <pre><code class="code-block">$ ls -l .git/objects/

total 12K
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 22:24 bd
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 13:19 info
drwxr-xr-x 2 gigachad gigachad 4.0K Sep  8 13:19 pack</code></pre>
              <p class="text text--label">
                Our blob starts with the <span class="code">bd</span> prefix, so
                it is stored in the
                <span class="code">.git/objects/bd</span> directory:
              </p>
              <pre><code class="code-block">$ ls -l .git/objects/bd

total 4
-r--r--r-- 1 gigachad gigachad 32 Sep  8 22:29 9dbf5aae1a3862dd1526723246b20206e5fc37</code></pre>
              <p class="text text--label">
                If you will try to view the content of the file with the
                <span class="code">cat</span> command, you will get some random
                characters, se we will output hex bytes, the same way as in the
                form above with the <span class="code">hexdump</span> command:
              </p>
              <pre><code class="code-block">$ hexdump -v -e '1/1 "%02x"' .git/objects/bd/9dbf5aae1a3862dd1526723246b20206e5fc37

78014bcac94f5230346328cf482c51c82c56282dd05148c94fb607005f1c079d%</code></pre>
              <p class="text">
                I strongly encourage you to verify the results. You can play
                around with the form above to see in real time, how the
                compression works.
              </p>
            </div>
          </main>
          <footer class="footer">
            <p>© 2023 <b>Maciej Biel</b></p>
          </footer>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
